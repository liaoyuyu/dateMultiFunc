!function(t){function e(t){(d=this).options={type:0,position:"bottom",radius:0,color:"#333333",background:"#ffffff",opacity:.7,selectBg:"#409EFE",selectColor:"#ffffff",selectRadius:100,tranBg:"#A0CFFF",tranColor:"#333333",title:"选择时间",isCancel:!0,cancelText:"取消",cancelFunc:()=>{},confirmText:"确认",confirmFunc:()=>{},backFormat:".",isShow:!1,appointTime:[],appointOn:[],minTime:"",maxTime:"",defaultYears:"",...t},this.currYears={},this.appointTimeArr=[],this.appointOnArr=[],this.minTimeJson={},this.maxTimeJson={},this.dateMultiEles={},this.selectTimes=[],this.selectObj=[],this.selectPeriod=[],this.init()}let d=null,i=(e.prototype={init(){this.transformOptionaTime(),this.create()},create(){let t=document.createElement("div"),e=(t.className="date_multi_popup",document.createElement("div")),i=(e.className="date_multi_bg",t.appendChild(e),document.createElement("div")),s=(i.className="date_multi_inner",document.createElement("div")),l=(s.className="date_multi_title",""),a=(this.options.isCancel&&((l=document.createElement("span")).innerHTML=this.options.cancelText,s.appendChild(l)),document.createElement("p")),o=(a.innerHTML=this.options.title,s.appendChild(a),document.createElement("span")),n=(o.innerHTML=this.options.confirmText,s.appendChild(o),i.appendChild(s),document.createElement("div")),r=(n.className="date_multi_title date_multi_time",document.createElement("p"));var p=this.getYearsDay(this.options.defaultYears,!0),p=(r.innerHTML=p.year+"年"+p.month+"日",document.createElement("span")),d=document.createElement("span");n.appendChild(p),n.appendChild(r),n.appendChild(d),i.appendChild(n);let c=document.createElement("div");c.className="date_multi_con",c.appendChild(this.createDateWeek()),i.appendChild(c),t.appendChild(i),document.body.appendChild(t);p={date_multi_popup:t,date_multi_bg:e,cancel_btn:l,date_multi_title:s,confirm_btn:o,time_tit:r,prev_month:p,next_month:d,date_multi_con:c};this.dateMultiEles=Object.assign(this.dateMultiEles,p),this.createdCss(),this.options.isShow&&this.show(),this.initEvent()},show(){this.dateMultiEles.date_list&&(this.isIEOrIE11()?this.dateMultiEles.date_list.removeNode(!0):this.dateMultiEles.date_list.remove()),this.createDateList(),setTimeout(()=>{this.options.isShow=!0,this.dateMultiEles.date_multi_popup&&(this.dateMultiEles.date_multi_popup.classList.add("date_multi_show"),document.body.style.overflow="hidden")},0)},close(){this.options.isShow=!1,this.dateMultiEles.date_multi_popup&&this.dateMultiEles.date_multi_popup.classList.remove("date_multi_show"),document.body.style.overflow="visible",this.clear()},clear(){this.selectTimes=[],this.selectObj=[],this.selectPeriod=[]},destroy(){try{let t=document.getElementById("date_multi_func_css");this.isIEOrIE11()?(this.dateMultiEles.date_multi_popup.removeNode(!0),t.removeNode(!0)):(this.dateMultiEles.date_multi_popup.remove(),t.remove()),this.removeEvent(),i=null}catch(t){}},modifyCssRadius(){10<this.options.selectRadius&&(this.options.selectRadius=10)},createdCss(){var t=`
                :root {
                    --date_multi_func-selectBg: ${this.options.selectBg};
                    --date_multi_func-selectColor: ${this.options.selectColor};
                    --date_multi_func-tranBg: ${this.options.tranBg};
                    --date_multi_func-tranColor: ${this.options.tranColor};
                    --date_multi_func-selectRadius:${this.options.selectRadius}%;
                    --date_multi_func-color:${this.options.color};
                    --date_multi_func-background:${this.options.background};
                    --date_multi_func-opacity:${this.options.opacity};
                }
                .date_multi_popup,.date_multi_popup *{
                    margin: 0;
                    padding: 0;
                }
                .date_multi_popup{
                    position: fixed;
                    z-index: 2000;
                    width: 100%;
                    height: 100%;
                    font-size: 13px;
                    top: 0;
                    left: 0;
                    display: -webkit-box;
                    display: -moz-box;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-box-direction: normal;
                    -webkit-box-orient: vertical;
                    -moz-flex-direction: column;
                    -webkit-flex-direction: column;
                    flex-direction: column;
                    -webkit-box-pack: end;
                    -moz-justify-content: flex-end;
                    -webkit-justify-content: flex-end;
                    justify-content: flex-end;
                    -webkit-box-align: center;
                    -moz-align-items: center;
                    -webkit-align-items: center;
                    align-items: center;
                    transition: all 0.2s;
                    opacity: 0;
                    visibility: hidden;
                    color: ${this.options.color};
                    color: var(--date_multi_func-color);
                }
                .date_multi_show{
                    opacity: 1;
                    visibility: visible;
                }
                .date_multi_popup .date_multi_bg{
                    position: absolute;
                    z-index: 1;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: #000;
                    opacity: ${this.options.opacity};
                    opacity: var(--date_multi_func-opacity);
                }
                .date_multi_popup .date_multi_inner{
                    position: relative;
                    z-index: 5;
                    width: 100%;
                    min-height: 20%;
                    padding-top: 6px;
                    box-shadow: 0px 0px 3px -1px #999;
                    transition: all 0.3s 0.2s;
                    transform: translateY(100%);
                    opacity: 0;
                    background-color: ${this.options.background};
                    background-color: var(--date_multi_func-background);
                }
                .date_multi_show .date_multi_inner{
                    transform: translateY(0);
                    opacity: 1;
                }
                .date_multi_popup .date_multi_title{
                    width: 100%;
                    position: relative;
                    line-height: 2.4;
                }
                .date_multi_popup .date_multi_title p{
                    font-size: 16px;
                    text-align: center;
                }
                .date_multi_popup .date_multi_title span{
                    display:block;
                    height: 100%;
                    position: absolute;
                    font-size: 14px;
                    left: 0;
                    top: 0;
                    padding: 0 20px;
                }
                .date_multi_popup .date_multi_title span:last-child{
                    left: auto;
                    right: 0;
                }
                .date_multi_popup .date_multi_time{
                    line-height: 2.4;
                }
                .date_multi_popup .date_multi_time p{
                    font-weight: bold;
                }
                .date_multi_popup .date_multi_time span{
                    padding: 0 15%;
                }
                .date_multi_popup .date_multi_time span::after{
                    position: absolute;
                    content: "";
                    display: block;
                    width: 0;
                    height: 0;
                    border-left: 6px solid transparent;
                    border-top: 4px solid transparent;
                    border-bottom: 4px solid transparent;
                    left: 50%;
                    margin-left: -4px;
                    top: 50%;
                    margin-top: -6px;
                    border-right: 6px solid ${this.options.color};
                    border-right: 6px solid var(--date_multi_func-color);
                }
                .date_multi_popup .date_multi_time span:last-child::after{
                    border-right: 6px solid transparent;
                    border-left: 6px solid ${this.options.color};
                    border-left: 6px solid var(--date_multi_func-color);
                }
                
                .date_multi_popup .date_multi_con{
                    width: 100%;
                    padding: 0 10px 15px 10px;
                    box-sizing: border-box;
                }
                /* 星期 */
                .date_multi_popup .date_week{
                    width: 100%;
                    overflow: hidden;
                    margin-bottom: 8px;
                    margin-top: 5px;
                    pointer-events: none;
                    display: -webkit-box;
                    display: -moz-box;
                    display: -ms-flexbox;
                    display: flex;
                }
                .date_multi_popup .date_week span{
                    display:block;
                    width: 14.28%;
                    text-align: center;
                    font-size: 13px;
                    line-height: 2.1;
                }
                /* 日期 */
                .date_multi_popup .date_list{
                    width: 100%;
                    height:calc(2.8em * 6);
                    overflow: hidden;
                    font-size: 14px;
                    display: -webkit-box;
                    display: -moz-box;
                    display: -ms-flexbox;
                    display: flex;
                    -webkit-flex-wrap: wrap;
                    -ms-flex-wrap: wrap;
                    flex-wrap: wrap;
                    -moz-align-content: flex-start;
                    -webkit-align-content: flex-start;
                    align-content:flex-start;
                }
                .date_multi_popup .date_list div{
                    display: block;
                    width: 14.28%;
                    overflow: hidden;
                    text-align: center;
                    line-height: 2.8em;
                    height: 2.8em;
                    position: relative;
                    z-index: 2;
                    transition: all 0.1s;
                }
                .date_multi_popup .date_list p{
                    display: block;
                    width: 100%;
                    overflow: hidden;
                    text-align: center;
                    line-height: inherit;
                    height: 100%;
                    position: relative;
                    z-index: 2;
                }
                /* 文本 */
                .date_multi_popup .date_list div span{
                    display:block;
                    position: absolute;
                    bottom: 2px;
                    left: 0;
                    width: 100%;
                    text-align: center;
                    font-size: 12px;
                    line-height: 1;
                    z-index: 3;
                    transform: scale(0.7);
                }
                /* 不可选样式 */
                .date_multi_popup .date_list div.on_select{
                    opacity: 0.3;
                    pointer-events: none;
                }
                
                /* 选中样式 */
                /* 第一个和最后一个 圆样式*/
                .date_multi_popup .date_list .select_firstlast p:before{
                    position: absolute;
                    content: "";
                    width: 60%;
                    height: 0;
                    padding-top: 60%;
                    top: 50%;
                    transform: translateY(-50%);
                    left: 20%;
                    z-index: -1;
                    border-radius: ${this.options.selectRadius}%;
                    background-color: ${this.options.selectBg};
                    border-radius: var(--date_multi_func-selectRadius);
                    background-color: var(--date_multi_func-selectBg);
                }
                .date_multi_popup .date_list .select_firstlast{
                    color: ${this.options.selectColor};
                    color: var(--date_multi_func-selectColor);
                }
                /* 范围间样式 */
                .date_multi_popup .date_list .select_period{
                    color: ${this.options.tranColor};
                    color: var(--date_multi_func-tranColor);
                }
                .date_multi_popup .date_list .select_period p::after,
                .date_multi_popup .date_list .select_firstlast p::after
                {
                    position: absolute;
                    content: "";
                    width: 100%;
                    height: 0;
                    padding-top: 60%;
                    top: 50%;
                    transform: translateY(-50%);
                    left: 0;
                    z-index: -2;
                    background-color: ${this.options.tranBg};
                    background-color: var(--date_multi_func-tranBg);
                }
                .date_multi_popup .date_list .select_firstlast p::after{
                    width: 50%;
                    opacity: 0;
                }
                /* 闭合样式 */
                .date_multi_popup .date_list .select_first p::after,
                .date_multi_popup .date_list .select_last p::after{
                    opacity: 1;
                }
                .date_multi_popup .date_list .select_first p::after{
                    right:0;
                    left:auto;
                }
            `;t+=`
                /* 圆角 数组就用数组圆角  不是数组就用 上面圆角*/
                .date_multi_popup .date_multi_inner{
                    border-radius:${this.options.radius.length?this.options.radius.join("px ")+"px":this.options.radius+"px"};
                }
                /* 位置*/
                .date_multi_popup{
                    ${"top"==this.options.position?"justify-content: flex-start":"center"==this.options.position?"justify-content: center":""}
                }
                .date_multi_popup .date_multi_inner{
                    transform: translateY(${"top"==this.options.position?"-100%":"center"==this.options.position?"50%":"100%"});
                }
                .date_multi_show .date_multi_inner{
                    transform: translateY(0);
                }
            `;let e=document.createElement("style");e.type="text/css",e.id="date_multi_func_css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),document.head.appendChild(e)},transformOptionaTime(){var t=this.getYearsDay(this.options.defaultYears);let e=this.options.minTime,l=this.options.maxTime;if(e=this.getMaxMinTime(e,0),(l=this.getMaxMinTime(l,1)).timestamp<e.timestamp)throw"最大时间应该比最小时间大！";(t.timestamp>l.timestamp||t.timestamp<e.timestamp)&&(this.options.defaultYears=e.timestamp);try{if(2!=this.options.type){let s=!1;if(this.options.appointTime.length){let i=[];if(this.options.appointTime.forEach(t=>{let e={};e=t.date?this.getYearsDay(t.date):this.getYearsDay(t),t.text?(e.text=t.text,s=!0):e.text="",i.push(e)}),i.sort((t,e)=>t.timestamp-e.timestamp),(this.appointTimeArr=i).length){var a=i[0];let t="";t=2<=i.length?i[i.length-1]:a,a.timestamp<e.timestamp&&(e=a,this.options.defaultYears=a.year+"/"+a.month+"/"+a.today),t.timestamp>l.timestamp&&(l=t)}}else if(this.options.appointOn.length){let i=[];this.options.appointOn.forEach(t=>{let e={};e=t.date?this.getYearsDay(t.date):this.getYearsDay(t),t.text?(e.text=t.text,s=!0):e.text="",i.push(e)}),i.sort((t,e)=>t.timestamp-e.timestamp),this.appointOnArr=i}s&&this.modifyCssRadius()}}catch(t){}this.minTimeJson=e,this.maxTimeJson=l},getMaxMinTime(t,e){let i=this.getYearsDay(this.options.defaultYears);try{switch(typeof t){case"string":t=""===t?(i.year=e?i.year+100:i.year-100,this.getYearsDay(`${i.year}/${i.month}/`+i.today)):this.getYearsDay(t);break;case"number":if(t%1!=0)throw"数字必须是整数！";t=Math.abs(t),i.year=e?i.year+t:i.year-t,t=this.getYearsDay(`${i.year}/${i.month}/`+i.today);break;default:throw"时间格式不正确！"}}catch(t){throw t}return t},getYearsDay(t,e){let i=new Date;if(t)try{if("string"==typeof t&&(t=(t=t.replace(/\-/g,"/")).replace(/\./g,"/")),"Invalid Date"==(t=new Date(t)))throw err;i=t}catch(t){throw"时间格式错误"}var t=i.getFullYear(),s=i.getMonth()+1,l=i.getDate(),a=i.getDay(),o=new Date(t+`/${s}/`+l).getTime(),n=new Date(t,s,0).getDate(),r=new Date(t,s-1,1).getDay();return e&&(this.currYears={year:t,month:s,today:l,currweek:a,days:n,oneweek:r,timestamp:o}),{year:t,month:s,today:l,currweek:a,days:n,oneweek:r,timestamp:o}},createDateWeek(){let s=document.createElement("div");s.className="date_week";for(let i=1;i<=7;i++){let t=document.createElement("span"),e="周日";switch(i){case 1:e="周日";break;case 2:e="周一";break;case 3:e="周二";break;case 4:e="周三";break;case 5:e="周四";break;case 6:e="周五";break;case 7:e="周六"}t.innerHTML=e,s.appendChild(t)}return s},createDateList(){let e=document.createElement("div");e.className="date_list";var{year:t,month:i,days:s,oneweek:a}=this.currYears,l=this.minTimeJson,o=this.maxTimeJson,l=(t==l.year&&i==l.month?this.dateMultiEles.prev_month.style.display="none":this.dateMultiEles.prev_month.style.display="block",t==o.year&&i==o.month?this.dateMultiEles.next_month.style.display="none":this.dateMultiEles.next_month.style.display="block",this.getNoSelectDate());let n=l.onSelects,r=l.apppintDate;var p=s+a;for(let l=0;l<p;l++){let s=document.createElement("div"),t=document.createElement("p");if(l>=a){let e=l-a+1,i=(t.innerHTML=e,n.filter(t=>t==e||t.today==e)[0]);if(i?s.classList.add("on_select"):(s.onclick=function(){d.dateClick(this)},i=r.filter(t=>t==e||t.today==e)[0]),i&&i.text){let t=document.createElement("span");t.innerHTML=i.text,s.appendChild(t)}}s.setAttribute("index",l),s.appendChild(t),e.appendChild(s)}this.dateMultiEles.date_multi_con.appendChild(e),this.dateMultiEles.date_list=e,this.setSelectStyle(),this.setSectionStyle()},getNoSelectDate(){let{year:e,month:i,days:t}=this.currYears,s=[],l=[];if(2!=this.options.type&&this.appointTimeArr.length){l=this.appointTimeArr.filter(t=>t.year==e&&t.month==i);for(let e=1;e<=t;e++)l.some(t=>t.today==e)||s.push(e)}else{var a,o=this.minTimeJson,n=this.maxTimeJson;if(2!=this.options.type&&this.appointOnArr.length&&(a=this.appointOnArr.filter(t=>t.year==e&&t.month==i),s.push(...a)),e==o.year&&i==o.month)for(let e=1;e<o.today;e++)s.some(t=>t.today==e)||s.push(e);if(e==n.year&&i==n.month)for(let e=n.today+1;e<=t;e++)s.some(t=>t.today==e)||s.push(e)}return{onSelects:s,apppintDate:l}},initEvent(){this.dateMultiEles.date_multi_bg.addEventListener("click",this.cancelFunc,!1),this.dateMultiEles.cancel_btn.addEventListener("click",this.cancelFunc,!1),this.dateMultiEles.confirm_btn.addEventListener("click",this.confirmFunc,!1),this.dateMultiEles.prev_month.addEventListener("click",this.prevMonthClick,!1),this.dateMultiEles.next_month.addEventListener("click",this.nextMonthClick,!1)},removeEvent(){this.dateMultiEles.date_multi_bg.removeEventListener("click",this.cancelFunc,!1),this.dateMultiEles.cancel_btn.removeEventListener("click",this.cancelFunc,!1),this.dateMultiEles.confirm_btn.removeEventListener("click",this.confirmFunc,!1),this.dateMultiEles.prev_month.removeEventListener("click",this.prevMonthClick,!1),this.dateMultiEles.next_month.removeEventListener("click",this.nextMonthClick,!1)},cancelFunc(){d.close(),d.options.cancelFunc()},confirmFunc(){if(d.selectTimes.length){let t=d.selectTimes;2==d.options.type&&(d.selectTimes[1]||(d.selectTimes[1]=d.selectTimes[0]),t={statrTime:d.selectTimes[0],endTime:d.selectTimes[1]}),d.options.confirmFunc(t),d.close()}},prevMonthClick(){d.prevNextMonthFunc()},nextMonthClick(){d.prevNextMonthFunc(!0)},prevNextMonthFunc(t){let{year:e,month:i,today:s}=d.currYears;t?12<++i&&(i=1,e++):--i<=0&&(i=12,e--),d.getYearsDay(`${e}/${i}/`+s,!0),this.isIEOrIE11()?d.dateMultiEles.date_list.removeNode(!0):d.dateMultiEles.date_list.remove(),d.createDateList(),d.dateMultiEles.time_tit.innerHTML=e+"年"+i+"日"},dateClick(t){var e=t.getElementsByTagName("p")[0],i=t.getElementsByTagName("span")[0]?t.getElementsByTagName("span")[0].innerText:"",{year:s,month:l}=this.currYears,e=Number(e.innerText);let a={year:s,month:l,today:e,time:s+this.options.backFormat+l+this.options.backFormat+e,timestamp:new Date(s+`/${l}/`+e).getTime(),text:i};if(t.classList.add("select_firstlast"),0==this.options.type)this.selectTimes=[],this.selectObj.length&&this.selectObj[0].classList.remove("select_firstlast"),this.selectObj=[t],this.selectTimes=[a];else if(1==this.options.type){let e=-1;if(this.isIEOrIE11()){for(let t=0;t<this.selectTimes.length;t++)if(this.selectTimes[t].timestamp==a.timestamp){e=t,console.log(t);break}}else e=this.selectTimes.findIndex(t=>t.timestamp==a.timestamp);void(0<=e?(this.selectObj[e].classList.remove("select_firstlast"),this.selectObj.splice(e,1),this.selectTimes.splice(e,1)):(this.selectObj.push(t),this.selectTimes.push(a)))}else if(2==this.options.type){if(2<=this.selectTimes.length){this.selectTimes=[];for(let t=0;t<this.selectObj.length;t++)this.selectObj[t].classList.remove("select_firstlast");this.selectObj=[],this.cleanSelectPeriod()}this.selectTimes.length?(this.selectObj.push(t),this.selectTimes.push(a),this.isTimeReverse()):(this.selectTimes=[a],this.selectObj=[t])}},isTimeReverse(){var t;this.selectTimes[0].timestamp>this.selectTimes[1].timestamp&&(t=this.selectTimes[0],this.selectTimes[0]=this.selectTimes[1],this.selectTimes[1]=t,t=this.selectObj[0],this.selectObj[0]=this.selectObj[1],this.selectObj[1]=t),this.setSectionStyle()},setSelectStyle(){if(this.selectTimes.length&&this.selectObj.length){let{year:i,month:s}=this.currYears,l=[];if(this.selectTimes.forEach((t,e)=>{t.year==i&&t.month==s&&(t.selectObjIndex=e,l.push(t))}),l.length){let i=this.dateMultiEles.date_list.children,s=0;for(let t=0;t<i.length;t++){let e=i[t].getElementsByTagName("p")[0].innerText;e=e?Number(e):"";var a=l.filter(t=>0<e&&t.today==e)[0];if(a&&(i[t].classList.add("select_firstlast"),this.selectObj[a.selectObjIndex]=i[t],s++),s>=l.length)return}}}},setSectionStyle(){if(this.selectPeriod=[],2===this.options.type&&2<=this.selectTimes.length&&this.selectTimes[0].timestamp!=this.selectTimes[1].timestamp){let t=-1,e=-1;var{year:l,month:a,days:o,oneweek:n}=this.currYears;l==this.selectTimes[0].year&&a==this.selectTimes[0].month&&(t=Number(this.selectObj[0].getAttribute("index"))),l==this.selectTimes[1].year&&a==this.selectTimes[1].month&&(e=Number(this.selectObj[1].getAttribute("index")));let i=0,s="";0<=t&&0<=e&&(i=e-t-1,s=this.selectObj[0].nextSibling),0<=t&&e<0&&(i=o+n-t-1,s=this.selectObj[0].nextSibling),t<0&&0<=e&&(i=e-n,s=this.dateMultiEles.date_list.children[n]),-1==t&&-1==e&&l>=this.selectTimes[0].year&&l<=this.selectTimes[1].year&&a>=this.selectTimes[0].month&&a<=this.selectTimes[1].month&&(i=o,s=this.dateMultiEles.date_list.children[n]);for(let t=0;t<i;t++)s.className="select_period",this.selectPeriod.push(s),s=s.nextSibling;this.selectObj[0].classList.add("select_first"),this.selectObj[1].classList.add("select_last")}},cleanSelectPeriod(){if(this.selectPeriod.length){for(let t=0;t<this.selectPeriod.length;t++)this.selectPeriod[t].className="";this.selectPeriod=[]}},isIEOrIE11(){return!!(window.ActiveXobject||"ActiveXObject"in window||/Trident\/7\./.test(navigator.userAgent))}},null);function s(t){if("object"!=typeof(t=void 0===t?{}:t))throw"参数格式错误！";i&&i.destroy(),i=new e(t)}s.prototype.show=function(){if(!i)throw"请先创建！";i.show()},s.prototype.destroy=function(){i&&i.destroy()},t.dateMultiFunc=s}(window);